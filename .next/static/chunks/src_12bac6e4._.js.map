{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/sbspdmnds/src/app/packages/actions.ts"],"sourcesContent":["'use server';\n\nimport { createClient } from '@supabase/supabase-js';\nimport { z } from 'zod';\n\n// --- CLIENTE SUPABASE (PÚBLICO) ---\nconst createSupabaseClient = () => {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error('Credenciais do Supabase não encontradas. Verifique as variáveis de ambiente.');\n  }\n  \n  return createClient(supabaseUrl, supabaseAnonKey);\n};\n\n// --- AÇÕES DE BUSCA DE DADOS ---\n\nexport async function getPublicPackages() {\n  try {\n    const supabase = createSupabaseClient();\n    const { data, error } = await supabase\n      .from('viagens')\n      .select('*')\n      .eq('ativo', true)\n      .order('destino', { ascending: true });\n\n    if (error) throw error;\n\n    return { packages: data };\n  } catch (error) {\n    console.error(\"Erro ao buscar pacotes públicos:\", error);\n    return { error: \"Não foi possível carregar os pacotes.\" };\n  }\n}\n\n\nexport async function getPublicPackageById(id: string) {\n  try {\n    const supabase = createSupabaseClient();\n\n    // Usando .limit(1) para contornar um possível bug no .single()\n    const { data, error } = await supabase\n      .from('viagens')\n      .select('*')\n      .eq('id', id)\n      .limit(1);\n\n    if (error) throw error;\n\n    if (!data || data.length === 0) {\n        return { pkg: null, error: `Pacote com ID ${id} não encontrado.` };\n    }\n\n    return { pkg: data[0] };\n\n  } catch (e) {\n    console.error(`Erro ao buscar pacote por ID ${id}:`, e);\n    return { pkg: null, error: \"Falha ao buscar dados do pacote.\" };\n  }\n}\n\n\n// --- AÇÕES DE FORMULÁRIO (MUTATIONS) ---\n\nconst ReservationSchema = z.object({\n  name: z.string().min(3, { message: 'O nome deve ter pelo menos 3 caracteres.' }),\n  email: z.string().email({ message: 'Por favor, insira um email válido.' }),\n});\n\nexport async function submitReservation(prevState: any, formData: FormData) {\n  try {\n    const validatedFields = ReservationSchema.safeParse({\n      name: formData.get('name'),\n      email: formData.get('email'),\n    });\n\n    if (!validatedFields.success) {\n      return {\n        message: 'Falha na validação. Por favor, verifique os campos.',\n        errors: validatedFields.error.flatten().fieldErrors,\n        success: false,\n      };\n    }\n\n    // Simulação de salvamento no banco de dados\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    return {\n      message: `Reserva confirmada para ${validatedFields.data.name}! Entraremos em contato em breve.`,\n      errors: { name: [], email: [] },\n      success: true,\n    };\n  } catch (e) {\n    console.error(\"Erro ao submeter reserva:\", e);\n    return {\n      message: 'Não foi possível processar a reserva.',\n      errors: { name: [], email: [] },\n      success: false,\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;;;IAmBsB,oBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///home/user/sbspdmnds/src/components/PackageImage.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Image, { ImageProps } from 'next/image';\n\n// Tipagem para as props do nosso componente\ninterface PackageImageProps extends Omit<ImageProps, 'src'> {\n  src: string | null | undefined;\n  fallbackSrc: any; // Aceita string ou objeto de imagem estática\n}\n\n/**\n * Um componente de imagem inteligente que tenta carregar uma URL de origem\n * e, em caso de erro (ex: imagem quebrada, 404), exibe uma imagem de fallback local.\n */\nexport default function PackageImage({ src, fallbackSrc, ...props }: PackageImageProps) {\n  const [currentSrc, setCurrentSrc] = useState(src || fallbackSrc);\n\n  useEffect(() => {\n    // Se a 'src' externa for fornecida, usamos ela. Se não, usamos o fallback.\n    setCurrentSrc(src || fallbackSrc);\n  }, [src, fallbackSrc]);\n\n  return (\n    <Image\n      key={currentSrc} // Força a recriação do componente quando a fonte muda\n      src={currentSrc}\n      // O evento onError é acionado se o carregamento da 'src' falhar.\n      // Nesse caso, mudamos o estado para a imagem de fallback.\n      onError={() => setCurrentSrc(fallbackSrc)}\n      {...props}\n    />\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAee,SAAS,aAAa,KAAiD;QAAjD,EAAE,GAAG,EAAE,WAAW,EAAE,GAAG,OAA0B,GAAjD;;IACnC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC,OAAO;IAEpD,IAAA,0KAAS;kCAAC;YACR,2EAA2E;YAC3E,cAAc,OAAO;QACvB;iCAAG;QAAC;QAAK;KAAY;IAErB,qBACE,6LAAC,2IAAK;QAEJ,KAAK;QACL,iEAAiE;QACjE,0DAA0D;QAC1D,SAAS,IAAM,cAAc;QAC5B,GAAG,KAAK;OALJ;;;;;AAQX;GAlBwB;KAAA","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///home/user/sbspdmnds/src/app/packages/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useMemo } from 'react';\nimport Link from 'next/link';\nimport { getPublicPackages } from './actions';\nimport PackageImage from '../../components/PackageImage';\n\n// --- Tipagem ---\ntype Package = { id: string; [key: string]: any; };\ntype Filters = { searchTerm: string; categories: string[]; transportTypes: string[]; };\n\n// --- Card de Pacote ---\nconst PackageCard = ({ pkg, index }: { pkg: Package; index: number }) => {\n  const localImagePaths = ['/imgs/rio_de_janeiro.jpg', '/imgs/salvador.jpg', '/imgs/amazonia.jpg'];\n  return (\n    <Link href={`/packages/${pkg.id}`} className=\"block group rounded-xl transform hover:-translate-y-2 transition-all duration-300 will-change-transform\">\n      <div className=\"bg-white h-full flex flex-col rounded-xl shadow-lg\">\n        <div className=\"relative h-56 rounded-t-xl overflow-hidden\">\n          <PackageImage fill sizes=\"(max-width: 768px) 100vw, 33vw\" src={pkg.imagem_url} fallbackSrc={localImagePaths[index % localImagePaths.length]} alt={`Viagem para ${pkg.destino}`} className=\"object-cover group-hover:scale-110 transition-transform duration-500\" />\n          <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\"></div>\n          <div className=\"absolute bottom-4 left-4\"><h3 className=\"text-2xl font-bold text-white\">{pkg.destino}</h3><p className=\"text-sm text-gray-200\">Saindo de {pkg.origem}</p></div>\n        </div>\n        <div className=\"p-6 flex flex-col flex-grow\"><p className=\"text-gray-600 mb-4 line-clamp-3 flex-grow\">{pkg.descricao || `Descubra as maravilhas de ${pkg.destino}.`}</p><div className=\"flex justify-between items-end gap-4 mt-4\"><div><p className=\"text-sm text-gray-500\">A partir de</p><p className=\"text-2xl font-bold text-green-600\">{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(pkg.preco)}</p></div><div className=\"py-2 px-5 bg-green-500 text-white font-semibold rounded-lg shadow-md group-hover:bg-green-600 transition-colors whitespace-nowrap\">Ver Detalhes</div></div></div>\n      </div>\n    </Link>\n  );\n};\n\n// --- Barra Lateral de Filtros ---\nconst FilterSidebar = ({ packages, onFilterChange, currentFilters }: { packages: Package[], onFilterChange: (newFilters: Partial<Filters>) => void, currentFilters: Filters }) => {\n  const availableCategories = useMemo(() => Array.from(new Set(packages.map(p => p.categoria).filter(Boolean))), [packages]);\n  const availableTransportTypes = useMemo(() => Array.from(new Set(packages.map(p => p.meio_transporte).filter(Boolean))), [packages]);\n\n  const handleCheckboxChange = (filterType: 'categories' | 'transportTypes', value: string) => {\n    const currentValues = currentFilters[filterType];\n    const newValues = currentValues.includes(value) ? currentValues.filter(v => v !== value) : [...currentValues, value];\n    onFilterChange({ [filterType]: newValues });\n  };\n\n  return (\n    <aside className=\"lg:col-span-1 bg-white p-6 rounded-xl shadow-lg h-fit sticky top-28\">\n      <h3 className=\"text-xl font-bold text-gray-800 mb-6 border-b pb-4\">Filtre sua Viagem</h3>\n      <div className=\"space-y-6\">\n        <div>\n          <h4 className=\"font-semibold text-gray-700 mb-3\">Categoria</h4>\n          <div className=\"space-y-2\">{availableCategories.map(c => (<label key={c} className=\"flex items-center space-x-3 cursor-pointer\"><input type=\"checkbox\" onChange={() => handleCheckboxChange('categories', c)} checked={currentFilters.categories.includes(c)} className=\"h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500\"/><span>{c}</span></label>))}</div>\n        </div>\n        <div className=\"border-t\"></div>\n        <div>\n          <h4 className=\"font-semibold text-gray-700 mb-3\">Meio de Transporte</h4>\n          <div className=\"space-y-2\">{availableTransportTypes.map(t => (<label key={t} className=\"flex items-center space-x-3 cursor-pointer\"><input type=\"checkbox\" onChange={() => handleCheckboxChange('transportTypes', t)} checked={currentFilters.transportTypes.includes(t)} className=\"h-5 w-5 rounded border-gray-300 text-green-600 focus:ring-green-500\"/><span>{t}</span></label>))}</div>\n        </div>\n      </div>\n    </aside>\n  );\n};\n\n// --- Página Principal de Pacotes ---\nexport default function PackagesPage() {\n  const [allPackages, setAllPackages] = useState<Package[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filters, setFilters] = useState<Filters>({ searchTerm: '', categories: [], transportTypes: [] });\n\n  useEffect(() => {\n    const loadPackages = async () => {\n      setLoading(true);\n      const { packages } = await getPublicPackages();\n      if (packages) setAllPackages(packages as Package[]);\n      setLoading(false);\n    };\n    loadPackages();\n  }, []);\n\n  const filteredPackages = useMemo(() => {\n    return allPackages.filter(p => \n      (filters.searchTerm === '' || p.destino.toLowerCase().includes(filters.searchTerm.toLowerCase()) || p.origem.toLowerCase().includes(filters.searchTerm.toLowerCase())) &&\n      (filters.categories.length === 0 || (p.categoria && filters.categories.includes(p.categoria))) &&\n      (filters.transportTypes.length === 0 || (p.meio_transporte && filters.transportTypes.includes(p.meio_transporte)))\n    );\n  }, [allPackages, filters]);\n\n  const handleFilterChange = (newFilters: Partial<Filters>) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      <header className=\"bg-white/90 backdrop-blur-md shadow-sm sticky top-0 z-40\">\n        <nav className=\"container mx-auto px-6 py-4 flex justify-between items-center\">\n          <Link href=\"/home\" className=\"flex items-center gap-3\"><img src=\"/imgs/travel_1000dp_FFF_FILL0_wght400_GRAD0_opsz48.svg\" alt=\"Jacarelli Viagens Logo\" className=\"h-8 w-8 bg-green-500 rounded-full p-1\" /><span className=\"text-2xl font-bold text-green-500\">Jacarelli Viagens</span></Link>\n          <Link href=\"/home\" className=\"py-2 px-5 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors\">Voltar</Link>\n        </nav>\n      </header>\n\n      <main className=\"container mx-auto px-6 py-12\">\n        <div className=\"bg-white p-6 rounded-xl shadow-lg mb-12\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <input type=\"text\" placeholder=\"Busque por origem ou destino...\" onChange={e => handleFilterChange({ searchTerm: e.target.value })} className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500\"/>\n            <button className=\"w-full md:w-auto px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors\">Buscar</button>\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\n          <FilterSidebar onFilterChange={handleFilterChange} packages={allPackages} currentFilters={filters} />\n          \n          <div className=\"lg:col-span-3\">\n            {loading ? <p className=\"text-center text-gray-500\">Carregando...</p> : filteredPackages.length === 0 ? (\n              <div className=\"text-center py-16 bg-white rounded-xl shadow-lg\"><h2 className=\"text-2xl font-bold text-gray-700\">Nenhum Pacote Encontrado</h2><p className=\"text-gray-500 mt-2\">Tente ajustar seus filtros!</p></div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                {filteredPackages.map((pkg, index) => <PackageCard key={pkg.id} pkg={pkg} index={index} />)}\n              </div>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}